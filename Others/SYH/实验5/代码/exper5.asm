SSTACK SEGMENT STACK
	DW 64 DUP(?)
SSTACK ENDS

DATA SEGMENT
	FLAG DB 11H
DATA ENDS

CODE SEGMENT
	ASSUME CS:CODE, SS:SSTACK, DS:DATA
	
START:
	MOV FLAG, 11H
	CLI
	;ICW1
	MOV DX, 0020H
	MOV AL, 11H
	OUT DX, AL
	
	;ICW2
	MOV DX, 0021H
	MOV AL, 08H
	OUT DX, AL
	
	;ICW3
	MOV DX, 0021H
	MOV AL, 04H
	OUT DX, AL
	
	;ICW4
	MOV DX, 0021H
	MOV AL, 07H
	OUT DX, AL
	
	;OCW1
	MOV DX, 0021H
	MOV AL, 0BFH
	OUT DX, AL
	
	STI
	
	;IR6
	MOV SI, 0038H
	MOV AX, OFFSET IR6
	MOV [SI], AX
	MOV AX, CS
	MOV [SI+2], AX
	
CONTINUE:
	CMP FLAG, 011H
	JE SQUARE
	CMP FLAG, 022H
	JE TRIANGLE
	CMP FLAG, 044H
	JE SAWTOOTH
	CMP FLAG, 088H
	JE LADDER
	
	MOV FLAG, 11H
	JMP CONTINUE
	
SQUARE:	
	MOV DX, 0600H
	MOV AL, 00H
	OUT DX, AL
	CALL DELAY
	MOV AL, 0F0H
	OUT DX, AL
	CALL DELAY
	JMP CONTINUE
	
	
TRIANGLE:
	MOV AX, 00H
AA1:	
	MOV DX, 0600H
	OUT DX, AL
	
	MOV CX, 03FFH
L1: LOOP L1

	INC AL
	CMP AL, 0F1H
	JNE AA1
	
	DEC AL
	DEC AL
AA2:
	OUT DX, AL
	
	MOV CX, 03FFH
L2: LOOP L2

	DEC AL
	JNE AA2
	JMP CONTINUE
	
	
SAWTOOTH:
	MOV AL, 00H
BB1:	
	MOV DX, 0600H
	OUT DX, AL
	
	MOV CX, 06FEH
L3: LOOP L3

	INC AL
	CMP AL, 0F1H
	JNE BB1
	JMP CONTINUE
	
	
LADDER:
	MOV AX, 00H
CC1:	
	MOV DX, 0600H
	OUT DX, AL
	
	MOV CX, 0FFFFH
L4: LOOP L4

	ADD AX, 010H
	CMP AX, 100H
	JNE CC1
	JMP CONTINUE
	
	
DELAY:
	PUSH CX
	PUSH AX
	MOV AX, 01FFH
L6:
	MOV CX, 02FFH
L5:
	LOOP L5
	DEC AL
	CMP AL, 00H
	JNE L6
	POP AX
	POP CX
	RET
	
IR6:
	ROL FLAG, 1
	IRET
	
CODE ENDS
	END START