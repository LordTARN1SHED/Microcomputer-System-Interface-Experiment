A8255    EQU  0600H
B8255    EQU  0602H
C8255    EQU  0604H
CON8255  EQU  0606H

SSTACK	SEGMENT STACK
		DW 32 DUP(?)
SSTACK	ENDS

DATA SEGMENT
TAB DB 3FH
	DB 06H
  	DB 5BH
	DB 4FH
	DB 66H
	DB 6DH
	DB 7DH
	DB 07H
	DB 7FH
	DB 6FH
FLAG DB 00H
POSI DB 00H
NUMB DB 00H

DATA ENDS

CODE SEGMENT
	ASSUME CS:CODE, SS:SSTACK, DS:DATA

START:
	;初始化8255方式控制字
	MOV DX, CON8255
	MOV AL, 89H
	OUT DX, AL
	
AA1:
	MOV POSI, 0DFH
	MOV CX, 0006H
	
	MOV DX, C8255
	IN AL, DX
	MOV NUMB, AL
AA2:
	MOV AX, 02FH
	RCR NUMB, 1H
	JC FL
	MOV FLAG, 00H
	JMP AA3
FL:
	MOV FLAG, 01H
AA3:
	CALL SHOW
	CALL DELAY
	
	DEC AX
	JNZ AA3
	
	ROR POSI, 1H
	LOOP AA2
	
	JMP AA1
	
DELAY:
	PUSH CX
	PUSH AX
	
	MOV CX, 01H
A5:	
	MOV AX, 0FH
A6:	
	DEC AX
	JNZ A6
	LOOP A5
	
	POP AX
	POP CX
	RET
	
SHOW PROC
	PUSH CX
	PUSH AX
	PUSH DX
	
	MOV DX, A8255
	MOV AL, POSI
	OUT DX, AL
	
	CMP FLAG, 00H
	JZ S_1
	CMP POSI, 0DFH
	JZ S0
	CMP POSI, 0EFH
	JZ S3
	CMP POSI, 0F7H
	JZ S0
	CMP POSI, 0FBH
	JZ S1
	CMP POSI, 0FDH
	JZ S1
	CMP POSI, 0FEH
	JZ S2
	
S_1:
	MOV AL, 00H
	JMP SSS
S0:
	MOV AL, 3FH
	JMP SSS
S1:
	MOV AL, 06H
	JMP SSS
S2:
	MOV AL, 5BH
	JMP SSS
S3:
	MOV AL, 4FH
	JMP SSS

SSS:
	MOV DX, B8255
	OUT DX, AL
	
	POP DX
	POP AX
	POP CX
	RET
SHOW ENDP
		
CODE	ENDS
		END  START